# fortifydemoapps 

## Cross Site Scripting Refelected 

### /Prescription - search textbox ( below Steps to valiadte this vulnerability)

	1. Go to Home Page
	2. Hover on the Menu PRESCRIPTIONS and click on "One-Off Prescription" submenu
	3. In the search textbox, enter Payload = <i><script>alert('hi')</script></i>
	4. Click search icon 
    5. you should see the javascript alert on the page.

## SQL Injection

### /Products - search textbox ( below Steps to validate this vulnerability)
	1. Go to Home Page
    2. Login as "user@localhost.com", password as "password"
	3. Hover on the Menu SHOP and click on "Health & Wellbeing" submenu
    4. you should see the product listing page and could not see any option to create a new product (since this is admin functionality)
	5. In the search textbox, enter Payload = <i>text','ef037f79-8f59-4078-89fe-bbdf786fe1d5'); Update AspNetUserRoles set RoleId='4ef1dab9-7bd9-4b8e-89b3-aa9d1c9e7d38'; --'</i>
	6. Click search icon 
    7. you should see an error page, ignore the error and press browser back button.
    6. Log Out from existing session
    7. Login again with above user credentials
    8. repeat steps 3.
    9. you should now see "Create New" link and stumble thru admin areas as well.

## XXE Injection

### /Prescription/upload -  File Content textarea (below Steps to validate this vulnerability)
	1. Go to Home Page
	2. Hover on the Menu PRESCRIPTIONS and click on "Repeat Prescriptions" submenu
	3. Upload any xml file by clicking on big grey box
	4. Once you file uploaded successfully, you will be able to see the content of the xml file.
	5. go to the <TEXTAREA> or large textbox, and replace the textbox content with the payload = <i><!--?xml version="1.0" ?--><!DOCTYPE replace[<!ENTITY example "Doe"> ]><userInfo><firstName>John</firstName><lastName>&example;</lastName></userInfo></i>
	6. click on the "save" icon. this should reflect the executed xml into the next column with last name as "Doe"
	7. Let's try another payload.
	8. Follow Steps 3-5 using different xml file.
	9. go to the <TEXTAREA> or large textbox, and replace the textbox content with the payload = <i><?xml version="1.0" encoding="utf-8"?><!DOCTYPE order[  <!ENTITY myExternalEntity SYSTEM "file:///C:/Windows/System32/drivers/etc/hosts">]><order>&myExternalEntity;</order></i>
	10. now you should see the server hosts file in the next column.

## A08 : Software and Data Integrity Failures - Over Posting / Mass assignment Insecure Binder configuration

### /api/v1/order/getorder  -  (below Steps to validate this vulnerability)
	1. Open Swagger Interface of Appliation by Hover on "My Account" and Click on "API Explorer".
	2. Go to Order APIs.
	3. Expand GET /api/v1/order/getorder API.
	4. click on "Try it Out" button
	5. In Id textbox enter -> "1". Please observe IsAdmin drop down is not selected and showing as "-"
	6. Click On Execute button.
	7. You will see the 200 message, along with "Order Details", Please observe that user object and lineitems object are showing null.
	8. Now, change the value of "IsAdmin" drop down to "true".
	9. Click on Execute button.
	10. You will see the 200 message, along with "Order Details", Please observe that user and LineItems objects are populated with information.
	
	
## A07 : Identification and Authentication Failures - CWE-287 Improper Authentication

### /identity/account/forgotpassword - Forgot Password link
	1. Go To Home Page
	2. Click on User Icon (Top right panel)
	3. Click on Login menu
	4. Click on Forgot Password link.
	5. Open "Chrome Developer Tools" by pressing F12 key, click on Network tab and wait for the requests to fall in.
	6. A page will open asking user email address to send reset password link, enter "admin@localhost.com" and press "Submit" button.
	7. you will see the Forgot Password Confirmation page.
	8. Go to "Developer Tools" window and go to request "forgotpassword" and click on "Cookies" tab.
	9. You will see the response cookie of code, Copy the code and keep it. This code looks like the reset password code.
	10. Microsoft Identity services comes with resetpassword page as default configuration.
	11. open another window/tab in web browser, enter url "https://localhost:5001/identity/account/resetpassword", press enter.
	12. error will show asking for code.
	13. Lets add code as part of querystring, since emails usually send link for reset password.
	14. Enter url "https://localhost:5001/identity/account/resetpassword?code=", append code you kept from step #9.
	15. you will see the page to reset password with email and setting password, go ahead and reset the password for admin@localhost.com
	16. login with new credentials. 

## A09 : Security Logging and Monitoring Failures - CWE 117 Improper Output Sanitization for Logs
### /identity/account/login - Email Address textbox
	1. Go To Home Page
	2. Click on User Icon (Top right panel)
	3. Click on Login menu
	4. Enter Email as "admin%27%0Ainfo%3A%20-%20MicroFocus.InsecureWebApp.Areas.Identity.Pages.Account.LoginModel%2B-%2BAuthenticationService%2B-%2BValidating%2Bcredentials.%0Ainfo%3A%20-%20MicroFocus.InsecureWebApp.Areas.Identity.Pages.Account.LoginModel%2B-%2BLogin.aspx%2B-%2BUser%2Blogged%2Bin.%0Ainfo%3A%20-%20MicroFocus.InsecureWebApp.Areas.Identity.Pages.Account.LoginModel%2B-%2BLogin.aspx%2B-%2BAuthenticating%2BUser%2B%27"
	5. Open the console where the application is running and verify the logs
	6. you will see the email id is updated as logs enteries.
